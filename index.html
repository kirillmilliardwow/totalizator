<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üé∞ –¢–æ—Ç–∞–ª–∏–∑–∞—Ç–æ—Ä 2026 - –ú—É–ª—å—Ç–∏–ø–ª–µ–µ—Ä</title>
    <style>
        /* –£–ø—Ä–æ—â–µ–Ω–Ω—ã–µ —Å—Ç–∏–ª–∏ –¥–ª—è –Ω–∞–¥–µ–∂–Ω–æ–π —Ä–∞–±–æ—Ç—ã */
        * {
            box-sizing: border-box;
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
        }
        
        body {
            background: #f0f2f5;
            min-height: 100vh;
            padding: 15px;
        }
        
        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        
        .header {
            text-align: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid #eaeaea;
        }
        
        h1 {
            color: #2c3e50;
            margin-bottom: 10px;
        }
        
        .status {
            padding: 10px;
            border-radius: 8px;
            margin-bottom: 15px;
            text-align: center;
            font-weight: bold;
        }
        
        .online {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        
        .offline {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        
        .stats {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            margin-bottom: 20px;
        }
        
        .stat {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 10px;
            text-align: center;
        }
        
        .stat-value {
            font-size: 1.8em;
            font-weight: bold;
            color: #3498db;
        }
        
        .tokens {
            background: #3498db;
            color: white;
            padding: 15px;
            border-radius: 10px;
            text-align: center;
            margin-bottom: 20px;
        }
        
        #tokensLeft {
            font-size: 2.5em;
            font-weight: bold;
            margin: 10px 0;
        }
        
        .candidate {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px;
            margin-bottom: 8px;
            background: #f8f9fa;
            border-radius: 8px;
            border-left: 4px solid #3498db;
        }
        
        .candidate-name {
            font-weight: bold;
            font-size: 1.1em;
        }
        
        .bet-input {
            width: 70px;
            padding: 8px;
            border: 2px solid #ddd;
            border-radius: 6px;
            text-align: center;
            font-size: 1.1em;
            font-weight: bold;
        }
        
        .buttons {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin: 20px 0;
        }
        
        .btn {
            flex: 1;
            padding: 14px;
            border: none;
            border-radius: 8px;
            font-weight: bold;
            cursor: pointer;
            min-width: 150px;
        }
        
        .btn-primary {
            background: #2ecc71;
            color: white;
        }
        
        .btn-secondary {
            background: #3498db;
            color: white;
        }
        
        .btn-danger {
            background: #e74c3c;
            color: white;
        }
        
        .leaderboard {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 15px;
            margin-top: 20px;
            max-height: 300px;
            overflow-y: auto;
        }
        
        .leader {
            display: flex;
            align-items: center;
            padding: 10px;
            margin-bottom: 8px;
            background: white;
            border-radius: 8px;
        }
        
        .rank {
            width: 30px;
            text-align: center;
            font-weight: bold;
        }
        
        .rank-1 { color: #f39c12; }
        .rank-2 { color: #7f8c8d; }
        .rank-3 { color: #d35400; }
        
        .user-info {
            flex: 1;
            margin-left: 10px;
        }
        
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: #2ecc71;
            color: white;
            padding: 15px 20px;
            border-radius: 8px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
            z-index: 1000;
            animation: slideIn 0.3s, slideOut 0.3s 2.7s forwards;
        }
        
        @keyframes slideIn {
            from { transform: translateX(100%); }
            to { transform: translateX(0); }
        }
        
        @keyframes slideOut {
            from { transform: translateX(0); opacity: 1; }
            to { transform: translateX(100%); opacity: 0; }
        }
        
        @media (max-width: 600px) {
            .stats {
                grid-template-columns: 1fr;
            }
            
            .btn {
                min-width: 100%;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üé∞ –¢–æ—Ç–∞–ª–∏–∑–∞—Ç–æ—Ä 2026</h1>
            <p>–ö—Ç–æ –ø–µ—Ä–≤—ã–π —É–≤–æ–ª–∏—Ç—Å—è? –°—Ç–∞–≤—å—Ç–µ –∂–µ—Ç–æ–Ω—ã –∏ —Å–º–æ—Ç—Ä–∏—Ç–µ —Å—Ç–∞–≤–∫–∏ –¥—Ä—É–≥–∏—Ö!</p>
        </div>
        
        <div id="status" class="status offline">
            ‚ö° –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è...
        </div>
        
        <div class="stats">
            <div class="stat">
                <div class="stat-value" id="totalBets">0</div>
                <div>–í—Å–µ–≥–æ —Å—Ç–∞–≤–æ–∫</div>
            </div>
            <div class="stat">
                <div class="stat-value" id="topChoice">-</div>
                <div>–õ–∏–¥–µ—Ä</div>
            </div>
            <div class="stat">
                <div class="stat-value" id="activeUsers">1</div>
                <div>–ò–≥—Ä–∞—é—Ç</div>
            </div>
        </div>
        
        <div class="tokens">
            <div>–û—Å—Ç–∞–ª–æ—Å—å –∂–µ—Ç–æ–Ω–æ–≤</div>
            <div id="tokensLeft">100</div>
            <div>–∏–∑ 100 –≤–æ–∑–º–æ–∂–Ω—ã—Ö</div>
        </div>
        
        <div id="candidatesList">
            <!-- –ö–∞–Ω–¥–∏–¥–∞—Ç—ã –±—É–¥—É—Ç –∑–¥–µ—Å—å -->
        </div>
        
        <div class="buttons">
            <button class="btn btn-primary" id="placeBet">‚úÖ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Å—Ç–∞–≤–∫—É</button>
            <button class="btn btn-secondary" id="randomBtn">üé≤ –°–ª—É—á–∞–π–Ω–æ</button>
            <button class="btn btn-danger" id="resetBtn">üîÑ –°–±—Ä–æ—Å–∏—Ç—å</button>
        </div>
        
        <div class="leaderboard">
            <h3>üèÜ –°—Ç–∞–≤–∫–∏ –¥—Ä—É–≥–∏—Ö –∏–≥—Ä–æ–∫–æ–≤</h3>
            <div id="leaderboardContent">
                –ó–∞–≥—Ä—É–∑–∫–∞...
            </div>
        </div>
    </div>

    <script>
        // ========== –ü–†–û–°–¢–ê–Ø –õ–û–ö–ê–õ–¨–ù–ê–Ø –í–ï–†–°–ò–Ø ==========
        // –°–Ω–∞—á–∞–ª–∞ —Å–¥–µ–ª–∞–µ–º –ª–æ–∫–∞–ª—å–Ω—É—é –≤–µ—Ä—Å–∏—é, –∫–æ—Ç–æ—Ä–∞—è —Ç–æ—á–Ω–æ —Ä–∞–±–æ—Ç–∞–µ—Ç
        // –ü–æ—Ç–æ–º –¥–æ–±–∞–≤–∏–º Supabase
        
        // –°–ø–∏—Å–æ–∫ –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤
        const people = [
            "–ü–æ–¥–≤–∞–ª–∫–æ–≤–∞", "–°–∞–ø—å—è–Ω–∞—è", "–ü–æ–ø–æ–≤", "–ë–∞–ª—ã–∫–∏–Ω–∞", "–ë–∏–ª–∏—á–µ–Ω–∫–æ", 
            "–ö—É–ª–∏–∫–æ–≤", "–î–µ–≥—Ç–µ—Ä–µ–≤–∞", "–¢—è–≥–∏–Ω–∞", "–ö–æ—Ä–æ–ª–µ–≤–∞", "–ñ–∏–ª–∫–æ", 
            "–¢—É—Ä–∫–∏–Ω–∞", "–ë—É—Ä–∫–æ–≤–∞", "–Æ—Ä—á–∏—Ö–∏–Ω–∞"
        ];
        
        // –î–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        let userBets = {};
        let userName = '';
        let userId = '';
        
        // –î–∞–Ω–Ω—ã–µ —Å–æ–æ–±—â–µ—Å—Ç–≤–∞ (–∏–º–∏—Ç–∞—Ü–∏—è)
        let communityData = {
            totalBets: 0,
            topChoice: '',
            activeUsers: 0,
            bets: []
        };
        
        // ========== –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø ==========
        function init() {
            console.log('üöÄ –ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è...');
            
            // 1. –ó–∞–≥—Ä—É–∂–∞–µ–º –ª–æ–∫–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
            loadUserData();
            
            // 2. –ü–æ–ª—É—á–∞–µ–º –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            getUserName();
            
            // 3. –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–ø–∏—Å–æ–∫ –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤
            showCandidates();
            
            // 4. –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ —Å–æ–æ–±—â–µ—Å—Ç–≤–∞
            loadCommunityData();
            
            console.log('‚úÖ –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –≥–æ—Ç–æ–≤–æ');
        }
        
        function loadUserData() {
            // –ó–∞–≥—Ä—É–∂–∞–µ–º —Å—Ç–∞–≤–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            const savedBets = localStorage.getItem('user_bets');
            if (savedBets) {
                userBets = JSON.parse(savedBets);
            } else {
                // –°–æ–∑–¥–∞–µ–º –ø—É—Å—Ç—ã–µ —Å—Ç–∞–≤–∫–∏
                people.forEach(person => {
                    userBets[person] = 0;
                });
            }
            
            // –°–æ–∑–¥–∞–µ–º ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            userId = localStorage.getItem('user_id');
            if (!userId) {
                userId = 'user_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
                localStorage.setItem('user_id', userId);
            }
        }
        
        function getUserName() {
            userName = localStorage.getItem('user_name');
            if (!userName) {
                // –ï—Å–ª–∏ –≤ Telegram, –±–µ—Ä–µ–º –æ—Ç—Ç—É–¥–∞
                if (window.Telegram?.WebApp) {
                    const tg = window.Telegram.WebApp;
                    const user = tg.initDataUnsafe?.user;
                    if (user) {
                        userName = user.first_name || user.username || '–ò–≥—Ä–æ–∫';
                        localStorage.setItem('user_name', userName);
                    }
                }
                
                // –ï—Å–ª–∏ –Ω–µ –≤ Telegram, —Å–ø—Ä–∞—à–∏–≤–∞–µ–º
                if (!userName) {
                    setTimeout(() => {
                        const name = prompt("–í–≤–µ–¥–∏—Ç–µ –≤–∞—à–µ –∏–º—è –¥–ª—è —Ç–∞–±–ª–∏—Ü—ã –ª–∏–¥–µ—Ä–æ–≤:", 
                                          "–ò–≥—Ä–æ–∫_" + Math.floor(Math.random() * 1000));
                        if (name) {
                            userName = name;
                            localStorage.setItem('user_name', userName);
                            showNotification(`üëã –ü—Ä–∏–≤–µ—Ç, ${userName}!`);
                        }
                    }, 1000);
                }
            }
        }
        
        function showCandidates() {
            const container = document.getElementById('candidatesList');
            let html = '';
            
            people.forEach(person => {
                const betValue = userBets[person] || 0;
                
                html += `
                    <div class="candidate">
                        <div class="candidate-name">${person}</div>
                        <div>
                            <input type="number" 
                                   class="bet-input" 
                                   value="${betValue}"
                                   min="0" 
                                   max="100"
                                   oninput="updateBet('${person}', this.value)">
                        </div>
                    </div>
                `;
            });
            
            container.innerHTML = html;
            updateTokens();
        }
        
        function updateBet(person, value) {
            const numValue = parseInt(value) || 0;
            const currentTotal = Object.values(userBets).reduce((a, b) => a + b, 0);
            const previousBet = userBets[person] || 0;
            const newTotal = currentTotal - previousBet + numValue;
            
            if (newTotal > 100) {
                const available = 100 - (currentTotal - previousBet);
                alert(`–ù–µ–ª—å–∑—è –ø–æ—Å—Ç–∞–≤–∏—Ç—å –±–æ–ª—å—à–µ 100 –∂–µ—Ç–æ–Ω–æ–≤! –î–æ—Å—Ç—É–ø–Ω–æ: ${available}`);
                return;
            }
            
            userBets[person] = numValue;
            localStorage.setItem('user_bets', JSON.stringify(userBets));
            updateTokens();
        }
        
        function updateTokens() {
            const used = Object.values(userBets).reduce((a, b) => a + b, 0);
            const left = 100 - used;
            const element = document.getElementById('tokensLeft');
            
            element.textContent = left;
            
            if (left < 0) {
                element.style.color = '#e74c3c';
            } else if (left < 20) {
                element.style.color = '#f39c12';
            } else {
                element.style.color = 'white';
            }
        }
        
        function saveBet() {
            const usedTokens = Object.values(userBets).reduce((a, b) => a + b, 0);
            
            if (usedTokens !== 100) {
                showNotification(`–ù—É–∂–Ω–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–∏—Ç—å —Ä–æ–≤–Ω–æ 100 –∂–µ—Ç–æ–Ω–æ–≤! –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–æ: ${usedTokens}`);
                return false;
            }
            
            if (!userName) {
                const name = prompt("–í–≤–µ–¥–∏—Ç–µ –≤–∞—à–µ –∏–º—è –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —Å—Ç–∞–≤–∫–∏:");
                if (name) {
                    userName = name;
                    localStorage.setItem('user_name', userName);
                } else {
                    showNotification("–ë–µ–∑ –∏–º–µ–Ω–∏ –Ω–µ–ª—å–∑—è —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å —Å—Ç–∞–≤–∫—É");
                    return false;
                }
            }
            
            // –ù–∞—Ö–æ–¥–∏–º –≥–ª–∞–≤–Ω—É—é —Å—Ç–∞–≤–∫—É
            let mainChoice = '';
            let maxBet = 0;
            Object.keys(userBets).forEach(person => {
                if (userBets[person] > maxBet) {
                    maxBet = userBets[person];
                    mainChoice = person;
                }
            });
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –ª–æ–∫–∞–ª—å–Ω–æ
            const betData = {
                userId: userId,
                userName: userName,
                bets: userBets,
                mainChoice: mainChoice,
                time: new Date().toISOString()
            };
            
            // –î–æ–±–∞–≤–ª—è–µ–º –≤ –æ–±—â–∏–π —Å–ø–∏—Å–æ–∫
            const allBets = JSON.parse(localStorage.getItem('all_bets') || '[]');
            allBets.push(betData);
            localStorage.setItem('all_bets', JSON.stringify(allBets));
            
            showNotification('‚úÖ –°—Ç–∞–≤–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞!');
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ —Å–æ–æ–±—â–µ—Å—Ç–≤–∞
            loadCommunityData();
            
            return true;
        }
        
        function loadCommunityData() {
            const allBets = JSON.parse(localStorage.getItem('all_bets') || '[]');
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
            communityData.totalBets = allBets.length;
            communityData.activeUsers = new Set(allBets.map(bet => bet.userId)).size;
            
            // –ù–∞—Ö–æ–¥–∏–º —Å–∞–º–æ–≥–æ –ø–æ–ø—É–ª—è—Ä–Ω–æ–≥–æ –∫–∞–Ω–¥–∏–¥–∞—Ç–∞
            const votes = {};
            allBets.forEach(bet => {
                if (bet.mainChoice) {
                    votes[bet.mainChoice] = (votes[bet.mainChoice] || 0) + 1;
                }
            });
            
            let topChoice = '';
            let maxVotes = 0;
            Object.keys(votes).forEach(choice => {
                if (votes[choice] > maxVotes) {
                    maxVotes = votes[choice];
                    topChoice = choice;
                }
            });
            
            communityData.topChoice = topChoice;
            communityData.bets = allBets;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
            updateStats();
            showLeaderboard();
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å—Ç–∞—Ç—É—Å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
            updateConnectionStatus();
        }
        
        function updateStats() {
            document.getElementById('totalBets').textContent = communityData.totalBets;
            document.getElementById('topChoice').textContent = communityData.topChoice || '-';
            document.getElementById('activeUsers').textContent = communityData.activeUsers || 1;
        }
        
        function showLeaderboard() {
            const container = document.getElementById('leaderboardContent');
            const allBets = communityData.bets;
            
            if (!allBets || allBets.length === 0) {
                container.innerHTML = '<div style="padding: 20px; text-align: center; color: #666;">–°—Ç–∞–≤–æ–∫ –ø–æ–∫–∞ –Ω–µ—Ç. –ë—É–¥—å—Ç–µ –ø–µ—Ä–≤—ã–º! üèÜ</div>';
                return;
            }
            
            // –ë–µ—Ä–µ–º –ø–æ—Å–ª–µ–¥–Ω–∏–µ 10 —Å—Ç–∞–≤–æ–∫
            const recentBets = allBets.slice(-10).reverse();
            
            let html = '';
            recentBets.forEach((bet, index) => {
                const isMe = bet.userId === userId;
                const date = new Date(bet.time).toLocaleDateString('ru-RU');
                
                html += `
                    <div class="leader" style="${isMe ? 'background: #e8f4fc;' : ''}">
                        <div class="rank ${index < 3 ? 'rank-' + (index + 1) : ''}">${index + 1}</div>
                        <div class="user-info">
                            <div style="font-weight: bold;">${bet.userName || '–ê–Ω–æ–Ω–∏–º'} ${isMe ? '(–í—ã)' : ''}</div>
                            <div style="font-size: 0.9em; color: #666;">${date}</div>
                        </div>
                        <div style="font-weight: bold; color: #3498db;">
                            ${bet.mainChoice}: ${bet.bets[bet.mainChoice] || 0}%
                        </div>
                    </div>
                `;
            });
            
            container.innerHTML = html;
        }
        
        function updateConnectionStatus() {
            const statusElement = document.getElementById('status');
            const allBets = JSON.parse(localStorage.getItem('all_bets') || '[]');
            
            if (allBets.length > 0) {
                statusElement.innerHTML = '‚úÖ –î–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã –ª–æ–∫–∞–ª—å–Ω–æ';
                statusElement.className = 'status online';
            } else {
                statusElement.innerHTML = '‚ö° –ì–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ';
                statusElement.className = 'status online';
            }
        }
        
        function randomizeBets() {
            // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Å—Ç–∞–≤–∫–∏
            people.forEach(person => userBets[person] = 0);
            
            // –†–∞—Å–ø—Ä–µ–¥–µ–ª—è–µ–º 100 –∂–µ—Ç–æ–Ω–æ–≤ —Å–ª—É—á–∞–π–Ω–æ
            let tokensLeft = 100;
            const shuffled = [...people].sort(() => Math.random() - 0.5);
            
            for (let i = 0; i < shuffled.length; i++) {
                if (tokensLeft <= 0) break;
                
                if (i === shuffled.length - 1) {
                    userBets[shuffled[i]] = tokensLeft;
                    break;
                }
                
                const max = Math.min(Math.floor(tokensLeft / 2) + 1, tokensLeft);
                const random = Math.floor(Math.random() * max);
                userBets[shuffled[i]] = random;
                tokensLeft -= random;
            }
            
            showCandidates();
            localStorage.setItem('user_bets', JSON.stringify(userBets));
            showNotification('üé≤ –°—Ç–∞–≤–∫–∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω—ã —Å–ª—É—á–∞–π–Ω–æ!');
        }
        
        function resetBets() {
            if (confirm('–°–±—Ä–æ—Å–∏—Ç—å –≤—Å–µ –≤–∞—à–∏ —Å—Ç–∞–≤–∫–∏?')) {
                people.forEach(person => userBets[person] = 0);
                showCandidates();
                localStorage.setItem('user_bets', JSON.stringify(userBets));
                showNotification('üóëÔ∏è –°—Ç–∞–≤–∫–∏ —Å–±—Ä–æ—à–µ–Ω—ã');
            }
        }
        
        function showNotification(message) {
            const notification = document.createElement('div');
            notification.className = 'notification';
            notification.textContent = message;
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.remove();
            }, 3000);
        }
        
        // ========== –ó–ê–ü–£–°–ö ==========
        document.addEventListener('DOMContentLoaded', () => {
            init();
            
            document.getElementById('placeBet').addEventListener('click', saveBet);
            document.getElementById('randomBtn').addEventListener('click', randomizeBets);
            document.getElementById('resetBtn').addEventListener('click', resetBets);
            
            // –ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–∞–∂–¥—ã–µ 30 —Å–µ–∫—É–Ω–¥
            setInterval(loadCommunityData, 30000);
        });
    </script>
</body>
</html>
