<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üé∞ –¢–æ—Ç–∞–ª–∏–∑–∞—Ç–æ—Ä 2026</title>
    <style>
        * {
            box-sizing: border-box;
            font-family: Arial, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            margin: 0;
            padding: 20px;
            color: #333;
        }
        
        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }
        
        .header {
            text-align: center;
            margin-bottom: 25px;
            padding-bottom: 20px;
            border-bottom: 2px solid #f0f0f0;
        }
        
        h1 {
            color: #667eea;
            margin: 0;
            font-size: 2em;
        }
        
        .subtitle {
            color: #666;
            margin-top: 10px;
        }
        
        .stats {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            margin-bottom: 25px;
        }
        
        .stat-box {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 12px;
            text-align: center;
            border: 1px solid #e9ecef;
        }
        
        .stat-value {
            font-size: 2em;
            font-weight: bold;
            color: #667eea;
        }
        
        .stat-label {
            font-size: 0.9em;
            color: #666;
            margin-top: 5px;
        }
        
        .token-display {
            background: linear-gradient(90deg, #667eea, #764ba2);
            color: white;
            padding: 20px;
            border-radius: 15px;
            text-align: center;
            margin-bottom: 25px;
        }
        
        #tokensLeft {
            font-size: 3em;
            font-weight: bold;
            display: block;
            margin: 10px 0;
        }
        
        .candidate-list {
            margin-bottom: 25px;
        }
        
        .candidate-row {
            display: flex;
            align-items: center;
            padding: 15px;
            margin-bottom: 10px;
            background: #f8f9fa;
            border-radius: 12px;
            border-left: 5px solid #667eea;
        }
        
        .candidate-name {
            flex: 1;
            font-weight: bold;
            font-size: 1.1em;
        }
        
        .bet-controls {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .bet-btn {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            border: none;
            background: #667eea;
            color: white;
            font-size: 1.2em;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .bet-btn:hover {
            background: #5a67d8;
            transform: scale(1.1);
        }
        
        .bet-value {
            width: 60px;
            text-align: center;
            font-size: 1.2em;
            font-weight: bold;
            border: 2px solid #ddd;
            border-radius: 8px;
            padding: 8px;
        }
        
        .buttons {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 25px;
            justify-content: center;
        }
        
        .btn {
            padding: 15px 25px;
            border: none;
            border-radius: 12px;
            font-size: 1em;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.2s;
            flex: 1;
            min-width: 180px;
        }
        
        .btn-primary {
            background: #48bb78;
            color: white;
        }
        
        .btn-primary:hover {
            background: #38a169;
        }
        
        .btn-secondary {
            background: #667eea;
            color: white;
        }
        
        .btn-secondary:hover {
            background: #5a67d8;
        }
        
        .btn-danger {
            background: #f56565;
            color: white;
        }
        
        .btn-danger:hover {
            background: #e53e3e;
        }
        
        .btn-warning {
            background: #ed8936;
            color: white;
        }
        
        .btn-warning:hover {
            background: #dd6b20;
        }
        
        .leaderboard {
            margin-top: 30px;
            background: #f8f9fa;
            border-radius: 15px;
            padding: 20px;
        }
        
        .leaderboard-item {
            display: flex;
            align-items: center;
            padding: 12px 15px;
            margin-bottom: 8px;
            background: white;
            border-radius: 10px;
            border-left: 4px solid transparent;
        }
        
        .leaderboard-item.me {
            border-left-color: #667eea;
            background: #edf2f7;
        }
        
        .rank {
            width: 40px;
            text-align: center;
            font-weight: bold;
            font-size: 1.2em;
        }
        
        .rank-1 { color: gold; }
        .rank-2 { color: silver; }
        .rank-3 { color: #cd7f32; }
        
        .user-name {
            flex: 1;
            margin-left: 15px;
            font-weight: bold;
        }
        
        .user-bet {
            color: #667eea;
            font-weight: bold;
        }
        
        .results {
            margin-top: 30px;
            padding: 20px;
            background: #f0fff4;
            border-radius: 15px;
            border-left: 5px solid #48bb78;
        }
        
        .footer {
            text-align: center;
            margin-top: 30px;
            padding-top: 20px;
            border-top: 1px solid #e9ecef;
            color: #666;
            font-size: 0.9em;
        }
        
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: white;
            padding: 15px 20px;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
            z-index: 1000;
            animation: slideIn 0.3s, slideOut 0.3s 2.7s forwards;
            border-left: 5px solid #48bb78;
        }
        
        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        
        @keyframes slideOut {
            from { transform: translateX(0); opacity: 1; }
            to { transform: translateX(100%); opacity: 0; }
        }
        
        .loading {
            text-align: center;
            padding: 40px;
            color: #666;
            font-size: 1.2em;
        }
        
        .community-stats {
            margin-top: 20px;
            padding: 15px;
            background: #edf2f7;
            border-radius: 12px;
        }
        
        @media (max-width: 600px) {
            .stats {
                grid-template-columns: 1fr;
            }
            
            .btn {
                min-width: 100%;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üé∞ –¢–æ—Ç–∞–ª–∏–∑–∞—Ç–æ—Ä 2026</h1>
            <div class="subtitle">–ö—Ç–æ –ø–µ—Ä–≤—ã–π —É–≤–æ–ª–∏—Ç—Å—è –≤ 2026 –≥–æ–¥—É?</div>
        </div>
        
        <div class="stats">
            <div class="stat-box">
                <div class="stat-value" id="totalBets">0</div>
                <div class="stat-label">–í—Å–µ–≥–æ —Å—Ç–∞–≤–æ–∫</div>
            </div>
            <div class="stat-box">
                <div class="stat-value" id="topCandidate">-</div>
                <div class="stat-label">–õ–∏–¥–µ—Ä</div>
            </div>
            <div class="stat-box">
                <div class="stat-value" id="activeUsers">1</div>
                <div class="stat-label">–ò–≥—Ä–∞—é—Ç</div>
            </div>
        </div>
        
        <div class="token-display">
            <div>–û—Å—Ç–∞–ª–æ—Å—å –∂–µ—Ç–æ–Ω–æ–≤</div>
            <div id="tokensLeft">100</div>
            <div>–∏–∑ 100 –≤–æ–∑–º–æ–∂–Ω—ã—Ö</div>
        </div>
        
        <div class="candidate-list" id="candidateList">
            <div class="loading">–ó–∞–≥—Ä—É–∑–∫–∞ –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤...</div>
        </div>
        
        <div class="buttons">
            <button class="btn btn-primary" id="placeBet">‚úÖ –°–¥–µ–ª–∞—Ç—å —Å—Ç–∞–≤–∫—É</button>
            <button class="btn btn-secondary" id="randomBtn">üé≤ –°–ª—É—á–∞–π–Ω–æ</button>
            <button class="btn btn-danger" id="resetBtn">üóëÔ∏è –°–±—Ä–æ—Å–∏—Ç—å</button>
            <button class="btn btn-warning" id="saveBtn" style="display:none;">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
        </div>
        
        <div class="community-stats">
            <h3>üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Å–æ–æ–±—â–µ—Å—Ç–≤–∞</h3>
            <div id="communityTop">
                –ó–∞–≥—Ä—É–∑–∫–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏...
            </div>
        </div>
        
        <div class="leaderboard">
            <h3>üèÜ –¢–∞–±–ª–∏—Ü–∞ –ª–∏–¥–µ—Ä–æ–≤</h3>
            <div id="leaderboard">
                <div class="loading">–ó–∞–≥—Ä—É–∑–∫–∞ —Ä–µ–π—Ç–∏–Ω–≥–∞...</div>
            </div>
        </div>
        
        <div id="results" style="display:none;">
            <h3>üìà –í–∞—à–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã</h3>
            <div id="resultsContent"></div>
        </div>
        
        <div class="footer">
            ‚ö†Ô∏è –í–∏—Ä—Ç—É–∞–ª—å–Ω–∞—è –∏–≥—Ä–∞ –¥–ª—è —Ä–∞–∑–≤–ª–µ—á–µ–Ω–∏—è. –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø—Ä–æ–≤–µ—Ä–∏–º 31.12.2026
        </div>
    </div>

    <script>
        // ========== –ü–†–û–°–¢–ê–Ø –í–ï–†–°–ò–Ø –ë–ï–ó SUPABASE ==========
        
        // –î–∞–Ω–Ω—ã–µ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤
        const people = [
            "–ü–æ–¥–≤–∞–ª–∫–æ–≤–∞", "–°–∞–ø—å—è–Ω–∞—è", "–ü–æ–ø–æ–≤", "–ë–∞–ª—ã–∫–∏–Ω–∞", "–ë–∏–ª–∏—á–µ–Ω–∫–æ", 
            "–ö—É–ª–∏–∫–æ–≤", "–î–µ–≥—Ç–µ—Ä–µ–≤–∞", "–¢—è–≥–∏–Ω–∞", "–ö–æ—Ä–æ–ª–µ–≤–∞", "–ñ–∏–ª–∫–æ", 
            "–¢—É—Ä–∫–∏–Ω–∞", "–ë—É—Ä–∫–æ–≤–∞", "–Æ—Ä—á–∏—Ö–∏–Ω–∞"
        ];

        // –õ–æ–∫–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (–∏–º–∏—Ç–∞—Ü–∏—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö)
        let userBets = {};
        let userName = '';
        let userId = '';
        let communityData = {
            totalBets: 0,
            topCandidate: '',
            activeUsers: 1,
            bets: []
        };

        // ========== –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø ==========
        function init() {
            console.log('–ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è...');
            
            // –ó–∞–≥—Ä—É–∂–∞–µ–º —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ —Å—Ç–∞–≤–∫–∏
            loadLocalData();
            
            // –ü–æ–ª—É—á–∞–µ–º –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            getUserName();
            
            // –†–µ–Ω–¥–µ—Ä–∏–º —Å–ø–∏—Å–æ–∫ –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤
            renderCandidateList();
            
            // –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–µ–º–æ-–¥–∞–Ω–Ω—ã–µ —Å–æ–æ–±—â–µ—Å—Ç–≤–∞
            loadCommunityData();
            
            console.log('–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –≥–æ—Ç–æ–≤–æ');
        }

        function loadLocalData() {
            // –ó–∞–≥—Ä—É–∂–∞–µ–º —Å—Ç–∞–≤–∫–∏ –∏–∑ localStorage
            const savedBets = localStorage.getItem('tot_user_bets');
            if (savedBets) {
                userBets = JSON.parse(savedBets);
            } else {
                // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –Ω—É–ª–µ–≤—ã–µ —Å—Ç–∞–≤–∫–∏
                people.forEach(person => {
                    userBets[person] = 0;
                });
            }
            
            // –ó–∞–≥—Ä—É–∂–∞–µ–º ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            userId = localStorage.getItem('tot_user_id');
            if (!userId) {
                userId = 'user_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
                localStorage.setItem('tot_user_id', userId);
            }
        }

        function getUserName() {
            userName = localStorage.getItem('tot_user_name');
            if (!userName) {
                // –ü—Ä–æ—Å–∏–º –∏–º—è –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ
                setTimeout(() => {
                    const name = prompt("–í–≤–µ–¥–∏—Ç–µ –≤–∞—à–µ –∏–º—è –¥–ª—è —Ç–∞–±–ª–∏—Ü—ã –ª–∏–¥–µ—Ä–æ–≤:", 
                                      "–ò–≥—Ä–æ–∫_" + Math.floor(Math.random() * 1000));
                    if (name) {
                        userName = name;
                        localStorage.setItem('tot_user_name', userName);
                        showNotification(`–ü—Ä–∏–≤–µ—Ç, ${userName}!`);
                    }
                }, 500);
            }
        }

        function renderCandidateList() {
            const container = document.getElementById('candidateList');
            let html = '';
            
            people.forEach(person => {
                const currentBet = userBets[person] || 0;
                
                html += `
                    <div class="candidate-row">
                        <div class="candidate-name">${person}</div>
                        <div class="bet-controls">
                            <button class="bet-btn" onclick="changeBet('${person}', -5)">-</button>
                            <input type="number" 
                                   class="bet-value" 
                                   value="${currentBet}"
                                   min="0" 
                                   max="100"
                                   onchange="setBetValue('${person}', this.value)"
                                   oninput="setBetValue('${person}', this.value)">
                            <button class="bet-btn" onclick="changeBet('${person}', 5)">+</button>
                        </div>
                    </div>
                `;
            });
            
            container.innerHTML = html;
            updateTokensLeft();
        }

        function changeBet(person, delta) {
            const current = userBets[person] || 0;
            const newValue = Math.max(0, Math.min(100, current + delta));
            userBets[person] = newValue;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∑–Ω–∞—á–µ–Ω–∏–µ –≤ –ø–æ–ª–µ –≤–≤–æ–¥–∞
            const input = document.querySelector(`input[onchange*="${person}"]`);
            if (input) {
                input.value = newValue;
            }
            
            updateTokensLeft();
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫—É —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è
            document.getElementById('saveBtn').style.display = 'block';
        }

        function setBetValue(person, value) {
            const numValue = parseInt(value) || 0;
            userBets[person] = Math.max(0, Math.min(100, numValue));
            updateTokensLeft();
            document.getElementById('saveBtn').style.display = 'block';
        }

        function updateTokensLeft() {
            const usedTokens = Object.values(userBets).reduce((a, b) => a + b, 0);
            const leftTokens = 100 - usedTokens;
            const tokenElement = document.getElementById('tokensLeft');
            
            tokenElement.textContent = leftTokens;
            
            // –ú–µ–Ω—è–µ–º —Ü–≤–µ—Ç –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –æ—Å—Ç–∞—Ç–∫–∞
            if (leftTokens < 0) {
                tokenElement.style.color = '#e53e3e';
                showNotification('‚ùå –°–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ –∂–µ—Ç–æ–Ω–æ–≤!');
            } else if (leftTokens < 20) {
                tokenElement.style.color = '#ed8936';
            } else {
                tokenElement.style.color = 'white';
            }
        }

        function saveBet() {
            const usedTokens = Object.values(userBets).reduce((a, b) => a + b, 0);
            
            if (usedTokens !== 100) {
                showNotification(`‚ùå –ù—É–∂–Ω–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–∏—Ç—å —Ä–æ–≤–Ω–æ 100 –∂–µ—Ç–æ–Ω–æ–≤! –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–æ: ${usedTokens}`);
                return false;
            }
            
            if (!userName) {
                const name = prompt("–í–≤–µ–¥–∏—Ç–µ –≤–∞—à–µ –∏–º—è –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —Å—Ç–∞–≤–∫–∏:");
                if (name) {
                    userName = name;
                    localStorage.setItem('tot_user_name', userName);
                } else {
                    showNotification("‚ùå –ë–µ–∑ –∏–º–µ–Ω–∏ –Ω–µ–ª—å–∑—è —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å —Å—Ç–∞–≤–∫—É");
                    return false;
                }
            }
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –ª–æ–∫–∞–ª—å–Ω–æ
            localStorage.setItem('tot_user_bets', JSON.stringify(userBets));
            
            // –û–ø—Ä–µ–¥–µ–ª—è–µ–º –≥–ª–∞–≤–Ω—É—é —Å—Ç–∞–≤–∫—É
            let topChoice = '';
            let maxBet = 0;
            Object.keys(userBets).forEach(person => {
                if (userBets[person] > maxBet) {
                    maxBet = userBets[person];
                    topChoice = person;
                }
            });
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Å—Ç–∞–≤–∫—É –≤ "–±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö" (localStorage)
            const betData = {
                userId: userId,
                userName: userName,
                bets: userBets,
                topChoice: topChoice,
                score: Math.floor(maxBet * 1.5),
                timestamp: new Date().toISOString()
            };
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö —Å—Ç–∞–≤–æ–∫
            const allBets = JSON.parse(localStorage.getItem('all_bets') || '[]');
            allBets.push(betData);
            localStorage.setItem('all_bets', JSON.stringify(allBets));
            
            showNotification('‚úÖ –°—Ç–∞–≤–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞!');
            showResults();
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É —Å–æ–æ–±—â–µ—Å—Ç–≤–∞
            updateCommunityStats(allBets);
            
            return true;
        }

        function loadCommunityData() {
            // –ó–∞–≥—Ä—É–∂–∞–µ–º –≤—Å–µ —Å—Ç–∞–≤–∫–∏
            const allBets = JSON.parse(localStorage.getItem('all_bets') || '[]');
            communityData.totalBets = allBets.length;
            communityData.activeUsers = new Set(allBets.map(bet => bet.userId)).size || 1;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º UI
            document.getElementById('totalBets').textContent = communityData.totalBets;
            document.getElementById('activeUsers').textContent = communityData.activeUsers;
            
            // –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤
            const candidateStats = {};
            people.forEach(person => candidateStats[person] = { total: 0, count: 0 });
            
            allBets.forEach(bet => {
                Object.keys(bet.bets).forEach(person => {
                    if (bet.bets[person] > 0) {
                        candidateStats[person].total += bet.bets[person];
                        candidateStats[person].count++;
                    }
                });
            });
            
            // –ù–∞—Ö–æ–¥–∏–º –ª–∏–¥–µ—Ä–∞
            let topCandidate = '';
            let maxVotes = 0;
            
            allBets.forEach(bet => {
                if (bet.topChoice) {
                    if (!candidateStats[bet.topChoice].votes) candidateStats[bet.topChoice].votes = 0;
                    candidateStats[bet.topChoice].votes = (candidateStats[bet.topChoice].votes || 0) + 1;
                    
                    if (candidateStats[bet.topChoice].votes > maxVotes) {
                        maxVotes = candidateStats[bet.topChoice].votes;
                        topCandidate = bet.topChoice;
                    }
                }
            });
            
            communityData.topCandidate = topCandidate;
            document.getElementById('topCandidate').textContent = topCandidate || "-";
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ç–æ–ø-3 —Å–æ–æ–±—â–µ—Å—Ç–≤–∞
            showCommunityTop(allBets);
            
            // –°—Ç—Ä–æ–∏–º —Ç–∞–±–ª–∏—Ü—É –ª–∏–¥–µ—Ä–æ–≤
            buildLeaderboard(allBets);
        }

        function updateCommunityStats(allBets) {
            communityData.totalBets = allBets.length;
            communityData.activeUsers = new Set(allBets.map(bet => bet.userId)).size;
            
            document.getElementById('totalBets').textContent = communityData.totalBets;
            document.getElementById('activeUsers').textContent = communityData.activeUsers;
            
            // –ü–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞–µ–º –ª–∏–¥–µ—Ä–∞
            const candidateVotes = {};
            allBets.forEach(bet => {
                if (bet.topChoice) {
                    candidateVotes[bet.topChoice] = (candidateVotes[bet.topChoice] || 0) + 1;
                }
            });
            
            let topCandidate = '';
            let maxVotes = 0;
            Object.keys(candidateVotes).forEach(candidate => {
                if (candidateVotes[candidate] > maxVotes) {
                    maxVotes = candidateVotes[candidate];
                    topCandidate = candidate;
                }
            });
            
            communityData.topCandidate = topCandidate;
            document.getElementById('topCandidate').textContent = topCandidate || "-";
            
            showCommunityTop(allBets);
            buildLeaderboard(allBets);
        }

        function showCommunityTop(allBets) {
            // –°—á–∏—Ç–∞–µ–º –≥–æ–ª–æ—Å–∞ –∑–∞ –≥–ª–∞–≤–Ω–æ–≥–æ –∫–∞–Ω–¥–∏–¥–∞—Ç–∞
            const candidateVotes = {};
            allBets.forEach(bet => {
                if (bet.topChoice) {
                    candidateVotes[bet.topChoice] = (candidateVotes[bet.topChoice] || 0) + 1;
                }
            });
            
            // –°–æ—Ä—Ç–∏—Ä—É–µ–º –ø–æ —É–±—ã–≤–∞–Ω–∏—é –≥–æ–ª–æ—Å–æ–≤
            const sortedCandidates = Object.entries(candidateVotes)
                .sort((a, b) => b[1] - a[1])
                .slice(0, 3);
            
            const container = document.getElementById('communityTop');
            
            if (sortedCandidates.length > 0) {
                let html = '';
                const medals = ['ü•á', 'ü•à', 'ü•â'];
                
                sortedCandidates.forEach(([candidate, votes], index) => {
                    html += `
                        <div style="padding: 10px; background: white; border-radius: 8px; margin-bottom: 8px; display: flex; justify-content: space-between;">
                            <div>${medals[index] || '‚Ä¢'} ${candidate}</div>
                            <div style="font-weight: bold; color: #667eea;">${votes} –≥–æ–ª–æ—Å–æ–≤</div>
                        </div>
                    `;
                });
                
                container.innerHTML = html;
            } else {
                container.innerHTML = '<div>–°—Ç–∞–≤–æ–∫ –ø–æ–∫–∞ –Ω–µ—Ç. –ë—É–¥—å—Ç–µ –ø–µ—Ä–≤—ã–º!</div>';
            }
        }

        function buildLeaderboard(allBets) {
            const container = document.getElementById('leaderboard');
            
            if (allBets.length === 0) {
                container.innerHTML = '<div class="loading">–ï—â–µ –Ω–µ—Ç —Å—Ç–∞–≤–æ–∫. –ë—É–¥—å—Ç–µ –ø–µ—Ä–≤—ã–º!</div>';
                return;
            }
            
            // –°–æ—Ä—Ç–∏—Ä—É–µ–º –ø–æ –æ—á–∫–∞–º
            const sortedBets = [...allBets].sort((a, b) => b.score - a.score);
            let html = '';
            let myPosition = 0;
            
            sortedBets.slice(0, 10).forEach((bet, index) => {
                const isMe = bet.userId === userId;
                if (isMe) myPosition = index + 1;
                
                const rankClass = index === 0 ? 'rank-1' : 
                                index === 1 ? 'rank-2' : 
                                index === 2 ? 'rank-3' : '';
                
                html += `
                    <div class="leaderboard-item ${isMe ? 'me' : ''}">
                        <div class="rank ${rankClass}">${index + 1}</div>
                        <div class="user-name">${bet.userName || '–ê–Ω–æ–Ω–∏–º'}</div>
                        <div class="user-bet">${bet.topChoice}: ${bet.bets[bet.topChoice]}%</div>
                    </div>
                `;
            });
            
            container.innerHTML = html;
        }

        function showResults() {
            const usedTokens = Object.values(userBets).reduce((a, b) => a + b, 0);
            
            if (usedTokens !== 100) {
                showNotification('–°–Ω–∞—á–∞–ª–∞ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–∏—Ç–µ –≤—Å–µ 100 –∂–µ—Ç–æ–Ω–æ–≤!');
                return;
            }
            
            // –ù–∞—Ö–æ–¥–∏–º –ø–æ–±–µ–¥–∏—Ç–µ–ª—è
            let topChoice = '';
            let maxBet = 0;
            Object.keys(userBets).forEach(person => {
                if (userBets[person] > maxBet) {
                    maxBet = userBets[person];
                    topChoice = person;
                }
            });
            
            // –°–æ—Ä—Ç–∏—Ä—É–µ–º –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤
            const sortedPeople = [...people].sort((a, b) => userBets[b] - userBets[a]);
            
            let resultsHtml = '<div style="margin-top: 15px;">';
            sortedPeople.forEach((person, index) => {
                if (userBets[person] > 0) {
                    resultsHtml += `
                        <div style="margin-bottom: 10px; padding: 10px; background: white; border-radius: 8px;">
                            <div style="display: flex; justify-content: space-between;">
                                <div>
                                    <strong>${index + 1}. ${person}</strong>
                                </div>
                                <div style="font-weight: bold; color: #48bb78;">
                                    ${userBets[person]}%
                                </div>
                            </div>
                            <div style="height: 10px; background: #e2e8f0; border-radius: 5px; margin-top: 5px;">
                                <div style="width: ${userBets[person]}%; height: 100%; background: #48bb78; border-radius: 5px;"></div>
                            </div>
                        </div>
                    `;
                }
            });
            resultsHtml += '</div>';
            
            const resultsDiv = document.getElementById('results');
            resultsDiv.style.display = 'block';
            
            document.getElementById('resultsContent').innerHTML = `
                <div style="padding: 15px; background: white; border-radius: 10px; margin-top: 15px;">
                    <h4 style="margin: 0 0 15px 0; color: #48bb78;">üéØ –í–∞—à –≥–ª–∞–≤–Ω—ã–π –≤—ã–±–æ—Ä: ${topChoice} (${maxBet}%)</h4>
                    ${resultsHtml}
                    <button onclick="shareResults()" style="width: 100%; padding: 12px; background: #667eea; color: white; border: none; border-radius: 8px; margin-top: 15px; font-weight: bold;">
                        üì§ –ü–æ–¥–µ–ª–∏—Ç—å—Å—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏
                    </button>
                </div>
            `;
            
            // –ü—Ä–æ–∫—Ä—É—á–∏–≤–∞–µ–º –∫ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º
            resultsDiv.scrollIntoView({ behavior: 'smooth' });
        }

        function shareResults() {
            const sortedPeople = [...people].sort((a, b) => userBets[b] - userBets[a]);
            const top3 = sortedPeople.slice(0, 3);
            
            let shareText = `üé∞ –ú–æ–π –ø—Ä–æ–≥–Ω–æ–∑, –∫—Ç–æ —É–≤–æ–ª–∏—Ç—Å—è –≤ 2026:\n\n`;
            top3.forEach((person, index) => {
                const medals = ['ü•á', 'ü•à', 'ü•â'];
                shareText += `${medals[index]} ${person}: ${userBets[person]}%\n`;
            });
            
            shareText += `\n–í—Å–µ–≥–æ —Å—Ç–∞–≤–æ–∫: ${communityData.totalBets}\n`;
            shareText += `–õ–∏–¥–µ—Ä —Å–æ–æ–±—â–µ—Å—Ç–≤–∞: ${communityData.topCandidate}\n\n`;
            shareText += `–ü—Ä–∏—Å–æ–µ–¥–∏–Ω—è–π—Ç–µ—Å—å: ${window.location.href}`;
            
            if (navigator.share) {
                navigator.share({
                    title: '–ú–æ–π –ø—Ä–æ–≥–Ω–æ–∑ –Ω–∞ —É–≤–æ–ª—å–Ω–µ–Ω–∏—è –≤ 2026',
                    text: shareText,
                    url: window.location.href
                });
            } else {
                navigator.clipboard.writeText(shareText);
                showNotification('üìã –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω—ã!');
            }
        }

        function randomizeBets() {
            // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –≤—Å–µ —Å—Ç–∞–≤–∫–∏
            people.forEach(person => {
                userBets[person] = 0;
            });
            
            // –†–∞—Å–ø—Ä–µ–¥–µ–ª—è–µ–º 100 –∂–µ—Ç–æ–Ω–æ–≤ —Å–ª—É—á–∞–π–Ω–æ
            let tokensLeft = 100;
            const shuffledPeople = [...people].sort(() => Math.random() - 0.5);
            
            for (let i = 0; i < shuffledPeople.length - 1; i++) {
                if (tokensLeft <= 0) break;
                
                if (i === shuffledPeople.length - 2) {
                    userBets[shuffledPeople[i]] = tokensLeft;
                    break;
                }
                
                const maxBet = Math.min(Math.floor(tokensLeft / 2) + 1, tokensLeft);
                const randomBet = Math.floor(Math.random() * maxBet);
                userBets[shuffledPeople[i]] = randomBet;
                tokensLeft -= randomBet;
            }
            
            renderCandidateList();
            document.getElementById('saveBtn').style.display = 'block';
            showNotification('üé≤ –°—Ç–∞–≤–∫–∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω—ã —Å–ª—É—á–∞–π–Ω–æ');
        }

        function resetBets() {
            if (confirm('–°–±—Ä–æ—Å–∏—Ç—å –≤—Å–µ –≤–∞—à–∏ —Å—Ç–∞–≤–∫–∏?')) {
                people.forEach(person => {
                    userBets[person] = 0;
                });
                
                renderCandidateList();
                document.getElementById('saveBtn').style.display = 'none';
                document.getElementById('results').style.display = 'none';
                showNotification('üóëÔ∏è –°—Ç–∞–≤–∫–∏ —Å–±—Ä–æ—à–µ–Ω—ã');
            }
        }

        function showNotification(message) {
            const notification = document.createElement('div');
            notification.className = 'notification';
            notification.textContent = message;
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.remove();
            }, 3000);
        }

        // ========== –ó–ê–ü–£–°–ö –ü–†–ò–õ–û–ñ–ï–ù–ò–Ø ==========
        document.addEventListener('DOMContentLoaded', () => {
            init();
            
            document.getElementById('placeBet').addEventListener('click', () => {
                const saved = saveBet();
                if (saved) {
                    document.getElementById('saveBtn').style.display = 'none';
                }
            });
            
            document.getElementById('randomBtn').addEventListener('click', randomizeBets);
            document.getElementById('resetBtn').addEventListener('click', resetBets);
            document.getElementById('saveBtn').addEventListener('click', saveBet);
        });
    </script>
</body>
</html>
